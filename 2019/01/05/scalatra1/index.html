<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="a personal blog"><title>Scalatra in Action 1. hello, world | Not determined yet</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/blog/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><link rel="apple-touch-icon" href="/blog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/blog/apple-touch-icon.png"><script src="https://www.googletagmanager.com/gtag/js?id=G-N73FWWZR9G" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-N73FWWZR9G');
</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><style type="text/css">
.spoiler {
  display: inline-flex;
}
p.spoiler {
  display: flex;
}
.spoiler a {
  pointer-events: none;
}
.spoiler-blur, .spoiler-blur > * {
  transition: text-shadow .5s ease;
}
.spoiler .spoiler-blur, .spoiler .spoiler-blur > * {
  color: rgba(0, 0, 0, 0);
  background-color: rgba(0, 0, 0, 0);
  text-shadow: 0 0 10px grey;
  cursor: pointer;
}
.spoiler .spoiler-blur:hover, .spoiler .spoiler-blur:hover > * {
  text-shadow: 0 0 5px grey;
}
.spoiler-box, .spoiler-box > * {
  transition: color .5s ease,
  background-color .5s ease;
}
.spoiler .spoiler-box, .spoiler .spoiler-box > * {
  color: black;
  background-color: black;
  text-shadow: none;
}</style><meta name="generator" content="Hexo 6.1.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Scalatra in Action 1. hello, world</h1><a id="logo" href="/blog/.">Not determined yet</a><p class="description">知其强，守其弱，为天下菜，为天下菜，可以下饭。</p></div><div id="nav-menu"><a class="current" href="/blog/."><i class="fa fa-home"> 首页</i></a><a href="/blog/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/blog/about/"><i class="fa fa-user"> 关于</i></a><a href="/blog/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><div class="alert alert-danger" role="alert"><i class="fa fa-exclamation-triangle warning"> 本文发表的时间过于久远，其中的信息可能已经有所发展或者不再适用于现阶段</i></div><h1 class="post-title">Scalatra in Action 1. hello, world</h1><div class="post-meta">2019-01-05<span> | </span><span class="category"><a href="/blog/categories/%E6%8A%80%E6%9C%AF/">技术</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 2.7k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 11</span><span class="post-meta-item-text"> 分钟</span></span></span></div><a class="disqus-comment-count" data-disqus-identifier="2019/01/05/scalatra1/" href="/blog/2019/01/05/scalatra1/#disqus_thread"></a><div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>首先我们来介绍下我们的主角：<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Scalatra">Scalatra</a>。</p>
<p>Scalatra是一个灵活而又可定制的轻量级框架，通过它你可以用Scala来编写后端服务。</p>
<p>你可能会问了，同样位置的框架有那么多，Python 有 Flask，tornado, Java有 Spring,<del>更别说世界上最好用的语言PHP了</del>就算同样是Scala开发，也有Play, Lift珠玉在前，Scalatra又有啥优势可言呢？</p>
<blockquote>
<p>Scalatra, with its minimalistic style, does one thing well: it makes HTTP actions trivially easy to express. Beyond that, it gets out of your way. This makes it easy to pick andchoose from tens of thousands of Java and Scala libraries to build exactly the application you need.              ——Scalatra in Action</p>
</blockquote>
<blockquote>
<p>Scalatra is a simple, accessible and free web micro-framework.</p>
<p>It combines the power of the JVM with the beauty and brevity of Scala, helping you quickly build high-performance web sites and APIs.                                        ——scalatra.org</p>
</blockquote>
<p>当你编程时，前端是一个绕不开的东西，当你做好了一个项目，像给别人展示，总不能拿着一长串莫名其妙的字符串，或者是一堆实点数说这就是你努力的成果，总归是要有一个界面的。</p>
<p>选择Scala是因为个人的喜好，喜欢那优雅简洁富有表达力的语句，而选择Scalatra则是看重它声称的<strong>简单、轻量级</strong>，<del>希望它不要像sbt一样</del></p>
<p>废话少说，先用用看呗。</p>
<p>本文编写时，我对于Scalatra还一片茫然，后面学习地深入了，发现前面写错了，肯定会回来修改，但是也有可能有遗漏的东西，欢迎各位指正。</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>工欲善其事，必先利其器。想要写程序，先得搭环境。</p>
<p>操作系统方面，选择lInux，具体的嘛，可以用ubuntu，也可以用Centos，可以用虚拟机，也可以用VPS，这里我为了方便直接操作，用的是Windows SubSystem Linux(简称WSL)。</p>
<p>要想建立Scalatra项目，首先需要一个JDK和一个sbt，sbt用来管理各种依赖，JDK用来将scala程序翻译成java字节码。</p>
<h3 id="Step-1-JDK"><a href="#Step-1-JDK" class="headerlink" title="Step 1: JDK"></a>Step 1: JDK</h3><p>如果你之前安装过JDK，那么只要查看下jdk的版本就行了。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">java -version</span></span><br><span class="line">java version &quot;1.8.0_181&quot;</span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_181-b13)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.181-b13, mixed mode)</span><br></pre></td></tr></table></figure>



<p>如果是JDK版本过低，还请升级到8，虽然说截至目前，JDK8已经停止了公共更新，最新的JDK已经更新到11了，但8目前还够用，等啥时候11的相关组件都配套了再升级过去，毕竟只是学习，对安全方面的要求没那么敏感。</p>
<p>如果你之前没有安装过JDK，可以从<a target="_blank" rel="noopener" href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">Oracle 官网</a> 或者<a target="_blank" rel="noopener" href="http://openjdk.java.net/install/index.html">Open JDK</a>下载需要的版本，具体安装过程网上到处都有，这里就不赘述了。</p>
<h3 id="Step-2-sbt"><a href="#Step-2-sbt" class="headerlink" title="Step 2: sbt"></a>Step 2: sbt</h3><p>不同于大名鼎鼎的JDK，这里有必要简单介绍下<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Sbt_(software)#cite_note-8">sbt</a>是个什么东西。(包含了我学习使用sbt过程中积累下来的深深的怨念，不想看的可以直接<a href="#1">跳过</a>)</p>
<p>sbt早先不叫sbt的，而叫SBT，除了大小写以外没有啥区别，看起来是吗？大写的时候一般来说代表缩写，当然，SBT在这里不是指sad but true，当项目初建时，是”Simple Build Tool”,过了一段时间，SBT又有了”Scala Build Tools”的含义(sbt是Scala社区中<em>事实上的</em>构建工具，由<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Lift_(web_framework)">Lift web framework </a>和<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Play_Framework">Play Framework使用</a>,当然它也能用来构建java项目)。</p>
<p>而现在sbt就叫<em>sbt</em>,还起了了个不明觉厉的绰号</p>
<blockquote>
<p>Nowadays we just call sbt “sbt”, and to reinforce that the name is no longer an <a target="_blank" rel="noopener" href="https://en.oxforddictionaries.com/definition/initialism">initialism</a> we always write it in all lowercase letters. However, we are cool with <a target="_blank" rel="noopener" href="https://ja.wikipedia.org/wiki/%E9%85%A2%E8%B1%9A">酢豚</a> (subuta) as a nickname.</p>
<p>​                                            ——<a target="_blank" rel="noopener" href="https://www.scala-sbt.org/1.x/docs/Faq.html">https://www.scala-sbt.org/1.x/docs/Faq.html</a></p>
</blockquote>
<p>我用的时候倒是一点也没体会到”Simple Build Tool”和”Scala Build Tools”的含义。<em><strong>Simple</strong></em> ?我从来没这么觉得，用得我整个人都觉得自己<em><strong>Simple</strong></em>了，在我看来，SBT是SB tools的缩写，先是展现其难用的特点，让你觉得自己是个SB，然后你用上一阵子，发现这东西真是个SB，包括但不限于以下几个问题:</p>
<ul>
<li>下载包时经常会出现找不到包的情况，有两个可能，一个是由于众所周知的网络问题，解决办法科学上网；一个是由于默认的地址里面是maven中心仓库，要下载的包可能不在这里，这时候就要你手动添加下载地址了，那么下载地址咋填？这就看你个人的检索功底了<del>Bug驱动的面向搜索引擎编程</del></li>
<li>[warn]     ::::::::::::::::::::::::::::::::::::::::::::::<br>[warn]     ::              FAILED DOWNLOADS            ::<br>[warn]     :: ^ see resolution messages for details  ^ ::<br>[warn]     ::::::::::::::::::::::::::::::::::::::::::::::<br>[warn]     ::<br>[warn]     ::::::::::::::::::::::::::::::::::::::::::::::</li>
<li>上面这条Bug我遇到过不止一次，初见这个Bug的时候咋搜都搜不到，花了我一天时间，而现在都过去快一年了。截至当前(2019年),这个<a target="_blank" rel="noopener" href="https://github.com/sbt/sbt/issues/3618">bug</a> 还没有修复，只能靠社区提供的tricks暂时解决，而围绕它提出的issues有7个以上，。</li>
</ul>
<p>至于其他的什么编译速度慢，打fat-jar时依赖冲突不好解决，就不提了，反正我每次写完<code>build.sbt</code>文件后都要把它当宝贝存着，指不定之后就要用上了。</p>
<p>“Scala Build Tools”也是，谁说只有你一家SBT了，Maven，gradle又不是吃干饭的。</p>
<p>怀着阴暗的想法揣度下，估计是官方也发现这个问题，才不好意思用SBT改成sbt（敢不敢叫Standard Buid Tool 呢）。</p>
<p>在我接触sbt前，从没想象过有这么一种构建工具，编译速度比eclipe慢，依赖问题比pip复杂，bug修复速度比IE还慢，sbt，你做到了(鼓掌)。</p>
<p><del>要不是入了你的坑早用Gradle了</del></p>
<p>或许等我进一步学习sbt后，或者版本更新后，会对其有所改观，但现在来说，sbt真TM难用。</p>
<p> <a name="1">(跳过了一大段牢骚)</a></p>
<p>sbt的安装过程可以参考<a target="_blank" rel="noopener" href="https://www.scala-sbt.org/1.x/docs/Setup.html">官方下载指导</a>,选择对应的版本和操作系统平台，按照文档安装即可。</p>
<p>以CentOS为例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo yum install sbt</span></span><br></pre></td></tr></table></figure>



<h2 id="构建项目：-Hello-World"><a href="#构建项目：-Hello-World" class="headerlink" title="构建项目： Hello, World"></a>构建项目： Hello, World</h2><h3 id="Giter8"><a href="#Giter8" class="headerlink" title="Giter8"></a>Giter8</h3><blockquote>
<p>a command line tool to apply templates defined on GitHub</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="http://www.foundweekends.org/giter8/index.html">Giter8</a>，简称g8，不像Kubernetes是因为中间有8个字母才简称k8s，g8很朴素，只取首尾两个字符作为简称。朴素的g8干的事情也很朴素，就是为程序生成模板。我们也可以用它来定制自定义的模板，这里不介绍如何自定义，只是简单使用。下面是一个简单的示例。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> /root/test</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sbt new eed3si9n/hello.g8</span></span><br><span class="line">[info] Set current project to test (in build file:/root/test/)</span><br><span class="line">[info] Set current project to test (in build file:/root/test/)</span><br><span class="line">name [hello]: </span><br><span class="line">scala_version [2.11.8]: </span><br><span class="line"></span><br><span class="line">Template applied in /root/test/./hello</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tree</span> </span><br><span class="line">.</span><br><span class="line">└── hello</span><br><span class="line">    ├── README.markdown</span><br><span class="line">    ├── app</span><br><span class="line">    │   └── src</span><br><span class="line">    │       └── main</span><br><span class="line">    │           └── scala</span><br><span class="line">    │               └── foo</span><br><span class="line">    │                   └── Hello.scala</span><br><span class="line">    ├── build.sbt</span><br><span class="line">    └── project</span><br><span class="line">        └── build.properties</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>要开始编写我们的第一个scalatra应用程序，我们需要借助g8来生成我们的模板。</p>

  <span class="spoiler" onclick="this.classList.toggle('spoiler')">
    <span class="spoiler-blur ">eed3si9n是sbt的作者</span>
  </span>


<h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello, World"></a>Hello, World</h3><p><strong>生成scalatra项目</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sbt new scalatra/scalatra.g8</span><br></pre></td></tr></table></figure>

<p>这会检查存放至github上的模板，并询问一些项目的配置项信息,<code>[]</code>内为默认值，比如<code>scalatra/scalatra.g8</code>的项目地址为<a target="_blank" rel="noopener" href="https://github.com/scalatra/scalatra.g8">https://github.com/scalatra/scalatra.g8</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sbt new scalatra/scalatra.g8</span></span><br><span class="line">[info] Set current project to scalatra-study (in build file:/mnt/d/IdeaProjects/scalatra-study/)</span><br><span class="line">[info] Set current project to scalatra-study (in build file:/mnt/d/IdeaProjects/scalatra-study/)</span><br><span class="line">organization [com.example]: com.github.counter2015</span><br><span class="line">name [My Scalatra Web App]: My first Scalatra Web App</span><br><span class="line">version [0.1.0-SNAPSHOT]: </span><br><span class="line">servlet_name [MyScalatraServlet]: </span><br><span class="line">package [com.example.app]: com.github.counter2015.app</span><br><span class="line">scala_version [2.12.6]: </span><br><span class="line">sbt_version [1.2.1]: </span><br><span class="line">scalatra_version [2.6.4]: </span><br><span class="line"></span><br><span class="line">Template applied in /mnt/d/IdeaProjects/scalatra-study/./my-first-scalatra-web-app</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tree</span> </span><br><span class="line">.</span><br><span class="line">└── my-first-scalatra-web-app</span><br><span class="line">    ├── README.md</span><br><span class="line">    ├── build.sbt</span><br><span class="line">    ├── project</span><br><span class="line">    │   ├── build.properties</span><br><span class="line">    │   └── plugins.sbt</span><br><span class="line">    └── src</span><br><span class="line">        ├── main</span><br><span class="line">        │   ├── resources</span><br><span class="line">        │   │   └── logback.xml</span><br><span class="line">        │   ├── scala</span><br><span class="line">        │   │   ├── ScalatraBootstrap.scala</span><br><span class="line">        │   │   └── com</span><br><span class="line">        │   │       └── github</span><br><span class="line">        │   │           └── counter2015</span><br><span class="line">        │   │               └── app</span><br><span class="line">        │   │                   └── MyScalatraServlet.scala</span><br><span class="line">        │   ├── twirl</span><br><span class="line">        │   │   ├── layouts</span><br><span class="line">        │   │   │   └── default.scala.html</span><br><span class="line">        │   │   └── views</span><br><span class="line">        │   │       └── hello.scala.html</span><br><span class="line">        │   └── webapp</span><br><span class="line">        │       └── WEB-INF</span><br><span class="line">        │           └── web.xml</span><br><span class="line">        └── test</span><br><span class="line">            └── scala</span><br><span class="line">                └── com</span><br><span class="line">                    └── github</span><br><span class="line">                        └── counter2015</span><br><span class="line">                            └── app</span><br><span class="line">                                └── MyScalatraServletTests.scala</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里就不具体讲解项目目录和每个文件的含义了。</p>
<p><strong>编译</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> my-first-scalatra-web-app</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sbt</span></span><br></pre></td></tr></table></figure>

<p>sbt首次编译时需要下载scalatra依赖的所有包，这需要花上一段时间。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sbt:My first Scalatra Web App&gt; jetty:start</span><br></pre></td></tr></table></figure>

<p>首次运行，下载<a target="_blank" rel="noopener" href="https://www.eclipse.org/jetty/">jetty</a>也需要花上一段时间。</p>

  <span class="spoiler" onclick="this.classList.toggle('spoiler')">
    <span class="spoiler-blur ">jetty是一个Web服务器，如果你接触过Tomcat或者Nginx就很好理解</span>
  </span>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2019-01-04 10:42:07.490:INFO:oejs.AbstractConnector:main: Started ServerConnector@865dd6&#123;HTTP/1.1,[http/1.1]&#125;&#123;0.0.0.0:8080&#125;</span><br></pre></td></tr></table></figure>

<p>当出现以上日志时说明正常启动。</p>
<p>可以在<a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080/</a> 查看我们的第一个scalatra网页。</p>
<p><img src="https://counter2015.com/picture/scalatra-1-1.jpg"></p>
<p>这个网页其实在<code>src/main/twirl/views/hello.scala.html</code>可以找到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@()</span><br><span class="line">@layouts.html.default(&quot;Scalatra: a tiny, Sinatra-like web framework for Scala&quot;, &quot;Welcome to Scalatra&quot;)&#123;</span><br><span class="line">  &lt;p&gt;Hello, Twirl!&lt;/p&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很奇怪的语法，对吧？那么谁调用的它呢？</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/main/scala/com/github/counter2015/app/MyScalatraServlet.scala</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.github.counter2015.app</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.scalatra._</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyScalatraServlet</span> <span class="keyword">extends</span> <span class="title">ScalatraServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  get(<span class="string">&quot;/&quot;</span>) &#123;</span><br><span class="line">    views.html.hello()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么最开始的调用者是谁呢？</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/main/scala/ScalatraBootstrap.scala</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.counter2015.app._</span><br><span class="line"><span class="keyword">import</span> org.scalatra._</span><br><span class="line"><span class="keyword">import</span> javax.servlet.<span class="type">ServletContext</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ScalatraBootstrap</span> <span class="keyword">extends</span> <span class="title">LifeCycle</span> </span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">init</span></span>(context: <span class="type">ServletContext</span>) &#123;</span><br><span class="line">    context.mount(<span class="keyword">new</span> <span class="type">MyScalatraServlet</span>, <span class="string">&quot;/*&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="一些其他的尝试"><a href="#一些其他的尝试" class="headerlink" title="一些其他的尝试"></a>一些其他的尝试</h2><p>如果我们不想在<code>8080</code>端口启动，该怎么做呢？    </p>
<p>build.sbt文件如下:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> <span class="type">ScalatraVersion</span> = <span class="string">&quot;2.6.4&quot;</span></span><br><span class="line"></span><br><span class="line">organization := <span class="string">&quot;com.github.counter2015&quot;</span></span><br><span class="line"></span><br><span class="line">name := <span class="string">&quot;My first Scalatra Web App&quot;</span></span><br><span class="line"></span><br><span class="line">version := <span class="string">&quot;0.1.0-SNAPSHOT&quot;</span></span><br><span class="line"></span><br><span class="line">scalaVersion := <span class="string">&quot;2.12.6&quot;</span></span><br><span class="line"></span><br><span class="line">resolvers += <span class="type">Classpaths</span>.typesafeReleases</span><br><span class="line"></span><br><span class="line">libraryDependencies ++= <span class="type">Seq</span>(</span><br><span class="line">  <span class="string">&quot;org.scalatra&quot;</span> %% <span class="string">&quot;scalatra&quot;</span> % <span class="type">ScalatraVersion</span>,</span><br><span class="line">  <span class="string">&quot;org.scalatra&quot;</span> %% <span class="string">&quot;scalatra-scalatest&quot;</span> % <span class="type">ScalatraVersion</span> % <span class="string">&quot;test&quot;</span>,</span><br><span class="line">  <span class="string">&quot;ch.qos.logback&quot;</span> % <span class="string">&quot;logback-classic&quot;</span> % <span class="string">&quot;1.2.3&quot;</span> % <span class="string">&quot;runtime&quot;</span>,</span><br><span class="line">  <span class="string">&quot;org.eclipse.jetty&quot;</span> % <span class="string">&quot;jetty-webapp&quot;</span> % <span class="string">&quot;9.4.9.v20180320&quot;</span> % <span class="string">&quot;container&quot;</span>,</span><br><span class="line">  <span class="string">&quot;javax.servlet&quot;</span> % <span class="string">&quot;javax.servlet-api&quot;</span> % <span class="string">&quot;3.1.0&quot;</span> % <span class="string">&quot;provided&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">enablePlugins(<span class="type">SbtTwirl</span>)</span><br><span class="line">enablePlugins(<span class="type">ScalatraPlugin</span>)</span><br></pre></td></tr></table></figure>


  <span class="spoiler" onclick="this.classList.toggle('spoiler')">
    <span class="spoiler-blur ">在build.sbt中添加一行”containerPort in Jetty :&#x3D; 8090”，就能从8090启动</span>
  </span>

<blockquote>
<p>每次代码更改后手动重新启动应用程序既缓慢又痛苦。使用自动代码重新加载工具可以轻松避免这种情况。</p>
<p>sbt将允许您<a target="_blank" rel="noopener" href="https://www.scala-sbt.org/1.x/docs/Triggered-Execution.html">在检测到代码更改时发出应用程序重新启动的信号</a>。重新启动的语法涉及<code>~</code>在要重新执行的命令前添加。要自动重新编译和重新加载应用程序，请运行以下命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sbt</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">~;jetty:stop;jetty:start</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p><img src="https://counter2015.com/picture/scalatra-1-2.jpg"></p>
<p><img src="https://counter2015.com/picture/scalatra-1-3.jpg"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">需要关闭时，在sbt中输入如下命令</span></span><br><span class="line">jetty:stop</span><br></pre></td></tr></table></figure>



<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>我们初步了解了scalatra框架的用法，构建了第一个应用程序，但是也引入了新的问题</p>
<ul>
<li>scalatra没有main函数，启动过程到底是怎么做到的？</li>
<li>为什么<code>views.html.hello()</code>就能调用<code>src/main/twirl/views/hello.scala.html</code>的模板代码？</li>
<li><code>hello.scala.html</code>这种奇特的语法是什么？</li>
<li><code>twirl</code>是什么？</li>
</ul>
<p>饭要一口一口吃，这些问题暂且放下，在继续学习的过程中，总会有解决的时刻。</p>
<p>至少我们能跑了一个Demo了，对吧（撒花<del>一篇hello world 水了这么多字</del></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a target="_blank" rel="noopener" href="http://scalatra.org/getting-started/first-project.html">http://scalatra.org/getting-started/first-project.html</a></li>
<li>Scalatra in Action</li>
<li>其实还有很多参考资料我没列出来是因为都在本文的链接里我就不想重新写了</li>
</ol>
</div><div class="post-copyright"><script type="text/javascript" src="/blog/js/copyright.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/blog/css/copyright.css"><p><span>版权声明：</span><p>除另有声明外，本博客文章均采用 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/"><b>知识共享(Creative Commons) 署名-非商业性使用-相同方式共享 3.0 中国大陆许可协议</b></a> 进行许可。</p></p></div><br><script type="text/javascript" src="/blog/js/share.js?v=1.0.0" async></script><a class="article-share-link" data-url="https://counter2015.github.io/blog/2019/01/05/scalatra1/" data-id="cl1f5m0tx000zhupv8hif85a4" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLklEQVR42u3aS27jMBAFQN//0s52gIHo90g6gajSyoglmcUADfbn9Yqv9z/X/3+5+jZ5z9XbXt+4MDAwbst4D6/xsq6+HTPaz+O1YWBgPIcx95PjH062YBxwk7VhYGBgtEEwfwoDAwPjG4xxKpuE5vZYiYGBgdEmsQmjDdZ/kItjYGDckJFX3X//81f6GxgYGLdivMurpbYp7uSqMDAwjmastzDHyHY4Y1yG+5DKYmBgHM3Iz1p54ro3ZW23DwMD4zzGXPk+36H1cls0fIaBgXE0Iy+u5YAkdM41LzfUCDEwMG7LaMNZ/u3cSNnc/RgYGOcxkgGvfPwiWXqyEcmzxQMYGBg3Z7S3tq2ClY0Yb+6H/gYGBsZBjLb41bYzV948+X/AwMB4DGPleNeG13yQohgIw8DAOI6RNxrz5DNfUBuyP/RgMTAwjmO0Rf+5slo7ljH+FQwMjCcz5kr864fFlebBZScWAwPjOEZbjt/bNth1MMXAwDib0R7XkoGw790TTbdhYGAcx1gpeyVBMG8PtC1VDAyMpzF2lft3HQHzhigGBsYTGCtp6ly5LW8h1Kk1BgbGcYz1g1p+dGsPmvkBEQMD42zGrpidHB/nRr42TI5gYGAcwciDbLKUdtii7mAkuTgGBsahjLlwORem595WtzAxMDAezMhDc/L+bedZDAwMjDjhbFPTOTwGBsYzGW0SmyxlJVjnW4aBgfEERp467kpfV0p4S41MDAyM+zF+ACjf9RtlN+MJAAAAAElFTkSuQmCC">分享</a><div class="tags"><a href="/blog/tags读书笔记"><i class="fa fa-tag">读书笔记</i></a><a href="/blog/tagsScalatra"><i class="fa fa-tag">Scalatra</i></a></div><div class="post-nav"><a class="pre" href="/blog/2019/01/06/puzzle2/">Scala Puzzle 2.UPSTAIRS downstairs</a><a class="next" href="/blog/2018/12/15/Kafka%20HDFS%20Sink%20Connector%20%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/">Kafka HDFS Sink Connector 简单使用</a></div><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/sukkaw/disqusjs/dist/disqusjs.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/sukkaw/disqusjs/dist/disqus.js"></script><script type="text/javascript" id="disqus-count-script">$(function() {
  var xhr = new XMLHttpRequest();
  xhr.open('GET', '//disqus.com/next/config.json', true);
  xhr.timeout = 2500;
  xhr.onreadystatechange = function () {
    if (xhr.readyState === 4 && xhr.status === 200) {
      $('.post-meta .post-comments-count').show();
      var s = document.createElement('script');
      s.id = 'dsq-count-scr';
      s.src = 'https://counter2015.disqus.com/count.js';
      s.async = true;
      (document.head || document.body).appendChild(s);
    }
  };
  xhr.ontimeout = function () { xhr.abort(); };
  xhr.send(null);
});
</script><div class="comments" id="disqus_thread"><script type="text/javascript">// Load comments with DisqusJS
function loadComments() {
  window.dsqjs = new DisqusJS({
    shortname: 'counter2015',
    siteName: 'Not determined yet',
    identifier: '2019/01/05/scalatra1/',
    url: 'https://counter2015.github.io/blog/2019/01/05/scalatra1/',
    title: 'Scalatra in Action 1. hello, world',
    api: '',
    apikey: '',
    admin: '',
    adminLabel: ''
  });
}
// Lazy load {# Credit: https://github.com/theme-next/hexo-theme-next/blob/master/layout/_third-party/comments/disqus.swig #}
(function () {
  var offsetTop = document.getElementById('disqus_thread').offsetTop - window.innerHeight;
  if (offsetTop <= 0) {
    // Load directly when there's no scrollbar
    window.addEventListener('load', loadComments, false);
  } else {
    var disqusScroll = function () {
      // offsetTop may changes because of manually resizing browser window or lazy loading images
      var offsetTop = document.getElementById('disqus_thread').offsetTop - window.innerHeight;
      var scrollTop = window.scrollY;

      // Pre-load comments a bit? (margin or anything else)
      if (offsetTop - scrollTop < 60) {
        window.removeEventListener('scroll', disqusScroll);
        loadComments();
      }
    };
    window.addEventListener('scroll', disqusScroll);
  }
})();
// Scroll to comments automatically if #comment-xxx anchor specified
window.addEventListener('load', function () {
  // I don't know why, it just works.
  window.setTimeout(function () {
    if (location.hash.indexOf('#comment-') !== -1) {
      document.getElementById('disqus_thread').scrollIntoView(true);
    }
  }, 100);
}, false);
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://counter2015.github.io/blog"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/puzzles/">puzzles</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/%E5%85%B6%E4%BB%96/">其他</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/%E6%8A%80%E6%9C%AF/">技术</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/blog/tags/%E5%A4%87%E5%BF%98/" style="font-size: 15px;">备忘</a> <a href="/blog/tags/redis/" style="font-size: 15px;">redis</a> <a href="/blog/tags/kafka/" style="font-size: 15px;">kafka</a> <a href="/blog/tags/hadoop/" style="font-size: 15px;">hadoop</a> <a href="/blog/tags/hbase/" style="font-size: 15px;">hbase</a> <a href="/blog/tags/%E4%BC%9A%E8%AE%AE/" style="font-size: 15px;">会议</a> <a href="/blog/tags/%E6%9D%82%E8%B0%88/" style="font-size: 15px;">杂谈</a> <a href="/blog/tags/scala/" style="font-size: 15px;">scala</a> <a href="/blog/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 15px;">读书笔记</a> <a href="/blog/tags/Scalatra/" style="font-size: 15px;">Scalatra</a> <a href="/blog/tags/zookeeper/" style="font-size: 15px;">zookeeper</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/blog/2019/04/07/puzzle5/">Scala Puzzle 5.The Missing List</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2019/04/05/scalatra4/">Scalatra in Action 4. 处理用户输入</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2019/04/05/baiduopen7th/">百度技术开放日7th</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2019/03/24/puzzle4/">Scala Puzzle 4.Now You See Me, Now You Don't</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2019/03/23/scalatra3/">Scalatra in Action 3. 你要去哪里？</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2019/03/23/hbase/">hbase安装指南</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2019/03/10/RedisLive/">Redis Live部署备忘</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2019/03/10/kafka-manager/">kafka manager简单部署备忘</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2019/03/09/name-theroy/">命名杂谈</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2019/02/23/puzzle3/">Scala Puzzle 3.Location, Location, Location</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//counter2015.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://wiki.hushhw.cn" title="hushhw's blog 身经百战见得多了" target="_blank">hushhw's blog 身经百战见得多了</a><ul></ul><a href="https://blog.iseki.space" title="isekiのNote" target="_blank">isekiのNote</a><ul></ul><a href="https://razertory.github.io" title="Razetory的技术博客" target="_blank">Razetory的技术博客</a><ul></ul><a href="https://blog.ajin.cloud" title="ajin的博客" target="_blank">ajin的博客</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2022 <a href="/blog/." rel="nofollow">Not determined yet.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/blog/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/blog/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/blog/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/blog/css/copycode.css"><script type="text/javascript" src="/blog/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/blog/js/smartresize.js?v=1.0.0"></script></div></body></html>